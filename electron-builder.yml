appId: com.learntech.app
productName: LearnTech
directories:
    buildResources: build

files:
    - '!**/.vscode/*'
    - '!src/*'
    - '!electron.vite.config.{js,ts,mjs,cjs}'
    - '!{.eslintcache,eslint.config.mjs,.prettierignore,.prettierrc.yaml,dev-app-update.yml,CHANGELOG.md,README.md}'
    - '!{.env,.env.*,.npmrc,pnpm-lock.yaml}'
    - '!{tsconfig.json,tsconfig.node.json,tsconfig.web.json}'

extraResources:
    - from: resources
      to: .
      filter:
          - '**/*'
    - from: src/database/migrations
      to: migrations
    - from: node_modules/sql.js/dist/sql-wasm.wasm
      to: sql-wasm/sql-wasm.wasm
    - from: node_modules/sql.js/dist/sql-wasm.js
      to: sql-wasm/sql-wasm.js

asarUnpack:
    - '**/*.{wasm,node}'
    - '**/database/**'

win:
    executableName: LearnTech
    icon: build/icon.ico
    target:
        - target: nsis
          arch:
              - x64

nsis:
    artifactName: ${name}-${version}-setup.${ext}
    shortcutName: ${productName}
    uninstallDisplayName: ${productName}
    createDesktopShortcut: always
    oneClick: false
    perMachine: false
    allowToChangeInstallationDirectory: true

mac:
    icon: build/icon.icns
    entitlementsInherit: build/entitlements.mac.plist
    category: public.app-category.developer-tools
    hardenedRuntime: true
    gatekeeperAssess: false
    notarize: false
    identity: null
dmg:
    artifactName: ${name}-${version}.${ext}

linux:
    icon: build/icon.png
    target:
        - target: AppImage
          arch:
              - x64
        - target: deb
          arch:
              - x64
    maintainer: LearnTech Team
    category: Development
    synopsis: Interactive learning platform for developers
    description: LearnTech is an interactive learning platform for developers
appImage:
    artifactName: ${name}-${version}.${ext}

npmRebuild: false
compression: maximum
asar: true

# Hook to create no-sandbox wrapper for Linux AppImage
# Fixes 60-second startup delay on Fedora, Arch, Debian, etc.
afterPack: ./scripts/afterPack.ts
publish:
    provider: github
    releaseType: release
electronDownload:
    mirror: https://npmmirror.com/mirrors/electron/
